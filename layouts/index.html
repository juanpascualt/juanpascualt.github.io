{{ define "main" }}
{{ $s := .Site.Data.site }}

<div class="wrapper">
  <header>
    <h1>{{ $s.name }}</h1>
    <p></p>
    <hr>

    {{ range $s.links }}
      <p class="contactinfo"><a href="{{ .href }}">{{ .label }}</a></p>
    {{ end }}

    <img src="{{ $s.photo }}" alt="Photo" class="profile">

    <br>
    {{ $s.position }}
    <br>
    {{ $s.affiliation }}
    <br>
    <a href="{{ $s.cv }}" target="_blank" rel="noopener">CV</a>
    |
    <a href="mailto:{{ $s.email }}">Email</a>
  </header>

  <section>
    <h2 id="bio">Welcome</h2>

    {{ range $s.intro }}
      <p>{{ . }}</p>
    {{ end }}

    <hr>

    <h2 id="workinprogress">Work in Progress</h2>

    {{ $pid := 1 }}
    {{ range $s.work_in_progress }}
      <h3 style="margin:20px 0 5px;">
        {{ .title }}
      </h3>

      {{ if .coauthors }}
        <p style="margin:0 0 5px;">
          (with
          {{ range $i, $a := .coauthors }}
            {{ if $i }}, {{ end }}
            <a href="{{ $a.url }}" target="_blank" rel="noopener">{{ $a.name }}</a>
          {{ end }})
        </p>
      {{ end }}

      <p style="margin:0 0 5px;">
        <a href="javascript:toggle({{ $pid }})">
          Abstract <span id="pubabslink_{{ $pid }}">▼</span>
        </a>
      </p>

      <span id="pubabs_{{ $pid }}" style="display:none;">
        <p class="abstract">{{ .abstract }}</p>
      </span>

      {{ $pid = add $pid 1 }}
    {{ end }}

    <hr>

    <h2 id="teaching">Teaching</h2>
    <h3>{{ $s.teaching.heading }}</h3>

    <ul>
      {{ range $s.teaching.items }}
        <li>
          <p>
            <strong>{{ .course }}</strong>
            for {{ .audience }} ({{ .years }})
          </p>
        </li>
      {{ end }}
    </ul>

  </section>

  <footer></footer>
</div>

<script>
  function toggle(pid) {
    const abs = document.getElementById("pubabs_" + pid);
    const link = document.getElementById("pubabslink_" + pid);
    if (!abs || !link) return;

    if (abs.style.display === "none") {
      abs.style.display = "inline";
      link.textContent = "▲";
    } else {
      abs.style.display = "none";
      link.textContent = "▼";
    }
  }
</script>
{{ end }}
